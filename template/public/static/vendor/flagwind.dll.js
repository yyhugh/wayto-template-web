var flagwind_23f0d79f07e5675e71c6=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}({7:function(e,t,n){e.exports=n},8:function(module,exports,__webpack_require__){
/*!
* flagwind-core v1.1.0 
* 
* Authors:
*      jason <jasonsoop@gmail.com>
* 
* Licensed under the MIT License.
* Copyright (C) 2010-2018 Flagwind Inc. All rights reserved. 
*/var factory;factory=function(exports){"use strict";var __extends=this&&this.__extends||(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),extendStatics,__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind,flagwind;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"eventProvider",{get:function(){return this._eventProvider||(this._eventProvider=new e.EventProvider(this)),this._eventProvider},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),t.start=function(t,n){var r=this;if(!t)throw new e.ArgumentException("context");if(!this._isStarted){this.dispatchEvent(new e.ApplicationEventArgs(this.STARTING,t));try{this._context=t,t.serviceFactory.default.register("applicationContext",t),this.initializeGlobalModules(t);var i=t.getWorkbench(n);i&&(i.addListener(i.OPENED,function(n){r._isStarted=!0,r.dispatchEvent(new e.ApplicationEventArgs(r.STARTED,t))}),i.addListener(i.CLOSED,function(e){r.exit()}),i.open(n))}catch(t){throw e.Logger.error(this,t),t}}},t.exit=function(){var t=this._context;if(t){this._isStarted=!1;var n=new e.CancelEventArgs(this.EXITING,this);this.dispatchEvent(n),n.cancel||(t.workbench&&t.workbench.close(),this.disposeGlobalModules(t),this._context=null)}},t.addListener=function(e,t,n,r){this.eventProvider.addListener(e,t,n,r)},t.removeListener=function(e,t,n){this.eventProvider.removeListener(e,t,n)},t.dispatchEvent=function(e){this.eventProvider.dispatchEvent(e)},t.initializeGlobalModules=function(e){e.modules.forEach(function(t,n){t&&t.initialize(e)})},t.disposeGlobalModules=function(e){e.modules.forEach(function(e,t){e&&e.dispose()})},t._isStarted=!1,t._context=null,t.STARTING="starting",t.STARTED="started",t.EXITING="exiting",t}();e.Application=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(e){e&&(this._applicationId=e)}return Object.defineProperty(t.prototype,"applicationId",{get:function(){return this._applicationId},set:function(t){if(!t)throw new e.ArgumentException("value");if(this._applicationId)throw new e.InvalidOperationException("The ApplicationId has specified already.");this._applicationId=t.trim()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e||""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serviceFactory",{get:function(){return e.ServiceProviderFactory.instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modules",{get:function(){return this._modules||(this._modules=new e.Set),this._modules},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"credential",{get:function(){return this._credential||(this._credential=e.LocalStorage.get("__credential__")),this._credential},set:function(t){this._credential=t,e.LocalStorage.set("__credential__",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"states",{get:function(){return this._states||(this._states=new e.Map),this._states},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workbench",{get:function(){return this._workbench},enumerable:!0,configurable:!0}),t.prototype.getWorkbench=function(e){return this._workbench||(this._workbench=this.createWorkbench(e)),this._workbench},t}();e.ApplicationContextBase=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n){if(!t)throw new e.ArgumentException;this._type=t,this._data=n}return Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(t){if(!t)throw new e.ArgumentException;this._source=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),t}();e.EventArgs=t}(flagwind||(flagwind={})),function(e){var t=function(e){function t(t,n){var r=e.call(this,t)||this;return r.context=n,r}return __extends(t,e),t}(e.EventArgs);e.ApplicationEventArgs=t}(flagwind||(flagwind={})),function(e){var t=function(e,t,n,r){this.type=e,this.listener=t,this.scope=n,this.once=r},n=function(){function n(t){this._source=t||this,this._events=new e.Map}return n.prototype.addListener=function(n,r,i,o){if(void 0===i&&(i=this),void 0===o&&(o=!1),!n||!r)throw new e.ArgumentException;var a=this._events.get(n);a||(a=new Array,this._events.set(n,a));for(var s=0,u=a;s<u.length;s++){var c=u[s];if(c.listener===r&&c.scope===i)return}a.push(new t(n,r,i,o))},n.prototype.removeListener=function(t,n,r){if(void 0===r&&(r=this),!t||!n)throw new e.ArgumentException;var i=this._events.get(t);if(i){for(var o=0,a=i.length;o<a;o++){var s=i[o];if(s.listener===n&&s.scope===r){i.splice(o,1);break}}0===i.length&&this._events.delete(t)}},n.prototype.hasListener=function(e){var t=this._events.get(e);return!!t&&t.length>0},n.prototype.dispatchEvent=function(){var t,n=arguments;switch(n.length){case 1:n[0]instanceof e.EventArgs?t=n[0]:e.Type.isString(n[0])&&(t=new e.EventArgs(n[0]));break;case 2:t=new e.EventArgs(n[0],n[1])}t.source=this._source;var r=this._events.get(t.type);if(r&&0!==r.length){for(var i=new Array,o=0,a=r;o<a.length;o++){(s=a[o]).listener.call(s.scope,t),s.once&&i.push(s)}for(;i.length;){var s=i.pop();this.removeListener(s.type,s.listener,s.scope)}}},n}();e.EventProvider=n}(flagwind||(flagwind={})),function(e){var t=function(t){function n(n){var r=t.call(this)||this;if(r.OPENING="opening",r.OPENED="opened",r.DEACTIVATING="deactivating",r.DEACTIVATED="deactivated",r.ACTIVATING="activating",r.CLOSING="closing",r.CLOSED="closed",r.TITLE_CHANGED="title_changed",!n)throw new e.ArgumentException;return r._status=0,r._title=n.title,r._applicationContext=n,r}return __extends(n,t),Object.defineProperty(n.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this._title},set:function(e){this._title!==e&&(this._title=e||"",this.onTitleChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"applicationContext",{get:function(){return this._applicationContext},enumerable:!0,configurable:!0}),n.prototype.open=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:if(0!==this._status)return[2];try{this.onOpening()}catch(e){throw this._status=0,e}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.onOpen(e)];case 2:return n.sent(),[3,4];case 3:throw t=n.sent(),1===this._status&&(this._status=0),t;case 4:return 1===this._status&&this.onOpened(),[2]}})})},n.prototype.close=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r;return __generator(this,function(i){switch(i.label){case 0:if(6===(t=this._status)||0===t)return[2,!1];if(1===t)throw new e.InvalidOperationException;n=new e.CancelEventArgs(this.CLOSING);try{this.onClosing(n)}catch(e){throw this._status=t,e}if(!0===n.cancel)return this._status=t,[2,!1];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.onClose()];case 2:return i.sent(),[3,4];case 3:throw r=i.sent(),6===this._status&&(this._status=t),r;case 4:return 0!==this._status&&this.onClosed(),[2,!0]}})})},n.prototype.deactivate=function(){var e=this._status;if(2===e){try{this.onDeactivateing()}catch(t){throw this._status=e,t}try{this.onDeactivate()}catch(t){throw 3===this._status&&(this._status=e),t}4!==this._status&&this.onDeactivated()}},n.prototype.activate=function(){var e=this._status;if(4===e){try{this.onActivating()}catch(t){throw this._status=e,t}try{this.onActivate()}catch(t){throw 5===this._status&&(this._status=e),t}5===this._status&&this.onActivated()}},n.prototype.onOpening=function(){this._status=1,this.dispatchEvent(this.OPENING)},n.prototype.onOpen=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},n.prototype.onOpened=function(){this._status=2,this.dispatchEvent(this.OPENED)},n.prototype.onClosing=function(e){this._status=6,this.dispatchEvent(e)},n.prototype.onClose=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},n.prototype.onClosed=function(){this._status=0,this.dispatchEvent(this.CLOSED)},n.prototype.onDeactivateing=function(){this._status=3,this.dispatchEvent(this.DEACTIVATING)},n.prototype.onDeactivate=function(){},n.prototype.onDeactivated=function(){this._status=4,this.dispatchEvent(this.DEACTIVATED)},n.prototype.onActivating=function(){this._status=5,this.dispatchEvent(this.ACTIVATING)},n.prototype.onActivate=function(){},n.prototype.onActivated=function(){this._status=2},n.prototype.onTitleChanged=function(){this.dispatchEvent(this.TITLE_CHANGED)},n}(e.EventProvider);e.WorkbenchBase=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n){if(!t||!e.RegexUtils.uri.test(t))throw new e.ArgumentException;this._uri=t,this._scheme=RegExp.$1,this._action=RegExp.$2,this._extras=n||new e.Map}return Object.defineProperty(t.prototype,"scheme",{get:function(){return this._scheme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"action",{get:function(){return this._action},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extras",{get:function(){return this._extras},enumerable:!0,configurable:!0}),t}();e.Broadcast=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n){if(!t||!n)throw new e.ArgumentException;this._manager=t,this._scheme=n.scheme,this._action=n.action,this._uri=n.uri,this._extras=n.extras,this._aborted=!1}return Object.defineProperty(t.prototype,"manager",{get:function(){return this._manager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scheme",{get:function(){return this._scheme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"action",{get:function(){return this._action},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extras",{get:function(){return this._extras},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aborted",{get:function(){return this._aborted},enumerable:!0,configurable:!0}),t.prototype.abort=function(){this._aborted=!0},t}();e.BroadcastContext=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){var t=arguments;if(1===t.length){var n=t[0];if(!e.RegexUtils.uri.test(n))throw new e.ArgumentException;this._scheme=RegExp.$1,this.actions.add(RegExp.$2)}else{var r=t[0],i=t[1];if(!r||!e.RegexUtils.scheme.test(r)||!i)throw new e.ArgumentException;this._scheme=r;for(var o=0,a=i;o<a.length;o++){var s=a[o];this.actions.add(s)}}this._priority=0}return Object.defineProperty(t.prototype,"scheme",{get:function(){return this._scheme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"priority",{get:function(){return this._priority},set:function(e){this._priority=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actions",{get:function(){return this._actions||(this._actions=new e.Set),this._actions},enumerable:!0,configurable:!0}),t}();e.BroadcastContract=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t){this._eventProvider=new e.EventProvider(this),this._receiverProvider=t||new e.BroadcastReceiverProvider}return Object.defineProperty(t.prototype,"eventProvider",{get:function(){return this._eventProvider},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"receiverProvider",{get:function(){return this._receiverProvider},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.register=function(e,t){this.eventProvider.hasListener(e.scheme)||this.eventProvider.addListener(e.scheme,this.onReceive,this),this.receiverProvider.register(e,t)},t.prototype.unregister=function(e){this.receiverProvider.unregister(e)},t.prototype.send=function(t){if(!t)throw new e.ArgumentException;this.eventProvider.dispatchEvent(t.scheme,t)},t.prototype.onReceive=function(t){for(var n=t.data,r=this.receiverProvider.resolve(n).getEnumerator(),i=this.createBroadcastContext(n);r.next();){var o=r.current;try{if(i.aborted)return;o.receive(i)}catch(t){e.Logger.error(this,t)}}},t.prototype.createBroadcastContext=function(t){return new e.BroadcastContext(this,t)},t}();e.BroadcastManager=t}(flagwind||(flagwind={})),function(e){var t=function(){function e(e,t){this._contract=e,this._receiver=t}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._contract.priority},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contract",{get:function(){return this._contract},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"receiver",{get:function(){return this._receiver},enumerable:!0,configurable:!0}),e}();e.BroadcastReceiverEntry=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){this._entries=new e.Map}return t.prototype.register=function(t,n){var r=this;if(!t||!n)throw new e.ArgumentException;t.actions.forEach(function(i){var o=t.scheme.concat(i),a=r._entries.get(o);a||(a=new e.Set,r._entries.set(o,a)),a.add(new e.BroadcastReceiverEntry(t,n))})},t.prototype.unregister=function(t){var n=this;if(!t)throw new e.ArgumentException;t.actions.forEach(function(e){var r=t.scheme.concat(e);n._entries.has(r)&&n._entries.delete(r)})},t.prototype.resolve=function(t){if(this._entries.has(t.uri)){var n=this._entries.get(t.uri),r=new e.Set;return n.sort(function(e,t){return t.priority-e.priority}),n.forEach(function(e){return r.add(e.receiver)}),r}return new e.Set},t}();e.BroadcastReceiverProvider=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){this._keys=[],this._values=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.set=function(e,t){var n=this._keys,r=n.indexOf(e);return-1===r&&(n[r=n.length]=e),this._values[r]=t,this},t.prototype.get=function(e){var t=this._keys.indexOf(e);return-1!==t?this._values[t]:void 0},t.prototype.has=function(e){return-1!==this._keys.indexOf(e)},t.prototype.delete=function(e){var t=this._keys.indexOf(e);return-1!==t&&(this._keys.splice(t,1),this._values.splice(t,1),!0)},t.prototype.clear=function(){this._keys.length=0,this._values.length=0},t.prototype.getEnumerator=function(){var t=this.entries();return new e.Enumerator(t)},t.prototype.forEach=function(t,n){for(var r=this._keys,i=this._values,o=0,a=r.length;o<a;o++)t.call(n,new e.KeyValuePair(r[o],i[o]),this)},t.prototype.keys=function(){return this._keys.concat()},t.prototype.values=function(){return this._values.concat()},t.prototype.entries=function(){var t=new Array;return this.forEach(function(n,r){t.push(new e.KeyValuePair(n.key,n.value))}),t},t.prototype.toString=function(){var e=Object.create(null);return this.forEach(function(t,n){e[t.key]=t.value}),JSON.stringify(e)},t}();e.Map=t}(flagwind||(flagwind={})),function(e){var t=new e.Map;e.receivable=function(n,r){if(!n)throw new e.InvalidOperationException("The broadcast uri is empty.");return function(i){var o=t.get(i),a=new e.BroadcastContract(n);r&&(a.priority=r),o||(o=e.Activator.createInstance(i),t.set(i,o)),e.BroadcastManager.instance.register(a,o)}}}(flagwind||(flagwind={})),function(e){var t=function(){function t(t){if(!t)throw new e.ArgumentException("items");this._index=0,this._current=void 0,this._items=t}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),t.prototype.next=function(){var e=this._items;return this._index<e.length&&(this._current=e[this._index++],!0)},t}();e.Enumerator=t}(flagwind||(flagwind={})),function(e){var t=function(){function e(e,t){this._key=e,this._value=t}return Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"["+(this._key||"")+", "+(this._value||"")+"]"},e}();e.KeyValuePair=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._values=[],(e=this._values).push.apply(e,t)}return Object.defineProperty(t.prototype,"size",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),t.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var i=r[n];this.has(i)||this._values.push(i)}return this},t.prototype.get=function(e){return this._values[e]},t.prototype.set=function(e,t){var n=this._values;e>=0&&e<n.length&&(this.has(t)||(n[e]=t))},t.prototype.delete=function(e){var t=this._values,n=t.indexOf(e);return-1!==n&&(t.splice(n,1),!0)},t.prototype.deleteAt=function(e){var t=this._values;e>=0&&e<t.length&&t.splice(e,1)},t.prototype.clear=function(){this._values.length=0},t.prototype.indexOf=function(e,t){return this._values.indexOf(e,t)},t.prototype.has=function(e){return-1!==this._values.indexOf(e)},t.prototype.getEnumerator=function(){return new e.Enumerator(this._values)},t.prototype.forEach=function(){for(var e=this._values,t=arguments[0],n=arguments[1],r=2===t.length,i=0,o=e.length;i<o;i++)r?t.call(n,e[i],this):t.call(n,e[i],i,this)},t.prototype.find=function(e,t){for(var n=this._values,r=0,i=n.length;r<i;r++)if(e.call(t,n[r],r,this))return n[r]},t.prototype.sort=function(e){var t=this._values;this._values=t.sort(e)},t.prototype.union=function(e){var t=e.values();return t.length>0&&this.add.apply(this,t),this},t.prototype.values=function(){return this._values.concat()},t.prototype.toString=function(){return Array.prototype.toString.call(this._values)},t}();e.Set=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n){void 0===t&&(t=""),void 0===n&&(n=!0),this.name=e.Type.isEmptyString(t)?e.StringUtils.trim(e.Type.getClassName(this),"Command").toLowerCase():t,this._enabled=n}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(t){if(!t)throw new e.ArgumentException;if(-1!==t.indexOf(".")||-1!==t.indexOf("/"))throw new e.ArgumentException;this._name=t.trim()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!0,configurable:!0}),t.prototype.canExecute=function(e){return this.enabled},t.prototype.execute=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.canExecute(e)?[4,this.onExecute(e)]:[2,null];case 1:return[2,t.sent()]}})})},t}();e.CommandBase=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){this._items=new e.Map}return Object.defineProperty(t.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),t.prototype.add=function(t,n){if(this._items.has(t))throw new e.ArgumentException("The command path '"+t+"' is existed.");this._items.set(t,n)},t.prototype.remove=function(e){return this._items.delete(e)},t.prototype.find=function(e){return this._items.get(e)||null},t.prototype.contains=function(e){return this._items.has(e)},t.prototype.getEnumerator=function(){return this._items.getEnumerator()},t.prototype.forEach=function(e,t){this._items.forEach(e,t)},t}();e.CommandCollection=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n,r,i,o){if(void 0===o&&(o=null),!r)throw new e.ArgumentException;this._executor=t,this._expression=n,this._command=r,this._parameter=i,this._extendedProperties=o}return Object.defineProperty(t.prototype,"executor",{get:function(){return this._executor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expression",{get:function(){return this._expression},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"command",{get:function(){return this._command},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parameter",{get:function(){return this._parameter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasExtendedProperties",{get:function(){return this._extendedProperties&&this._extendedProperties.size>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extendedProperties",{get:function(){return this._extendedProperties||(this._extendedProperties=new e.Map),this._extendedProperties},enumerable:!0,configurable:!0}),t}();e.CommandContext=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t){this._commands=new e.CommandCollection,this._parser=t||e.CommandExpressionParser.instance}return Object.defineProperty(t,"default",{get:function(){return this._default||(this._default=new t),this._default},set:function(t){if(!t)throw new e.ArgumentException("value");this._default=t},enumerable:!0,configurable:!0}),t.prototype.register=function(e,t){this._commands.add(e,t)},t.prototype.remove=function(e){return this._commands.remove(e)},t.prototype.find=function(e){return this._commands.find(e)},t.prototype.execute=function(t,n){return void 0===n&&(n=null),__awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(i){if(!t)throw new e.ArgumentException;r=null;try{if(!(r=this.createExecutorContext(t,n)))throw new e.InvalidOperationException("Create executor context failed.")}catch(t){return e.Logger.error(this,t),[2,null]}return[2,this.onExecute(r)]})})},t.prototype.onExecute=function(t){return __awaiter(this,void 0,void 0,function(){var n,r,i,o,a,s,u;return __generator(this,function(c){switch(c.label){case 0:for(n=new Array,r=t.expression;null!==r;){if(!(i=this.find(r.fullPath)))throw new e.InvalidOperationException("The command path '"+r.fullPath+"' can not found.");n.push([r,i]),r=r.next}if(o=t.parameter,n.length<1)return[2,null];a=0,s=n.length,c.label=1;case 1:return a<s?(u=n[0],[4,this.executeCommand(t,u[0],u[1],o)]):[3,4];case 2:o=c.sent(),c.label=3;case 3:return a++,[3,1];case 4:return[2,o]}})})},t.prototype.executeCommand=function(t,n,r,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:if(!t||!n)throw new e.ArgumentException;return r?[4,r.execute(this.createCommandContext(n,r,i))]:[2,null];case 1:return[2,o.sent()]}})})},t.prototype.createExecutorContext=function(t,n){var r=this.onParse(t);if(!r)throw new e.InvalidOperationException("Invalid command expression text: "+t+".");return new e.CommandExecutorContext(this,r,n)},t.prototype.createCommandContext=function(t,n,r){return new e.CommandContext(this,t,n,r)},t.prototype.onParse=function(e){return this._parser.parse(e)},t}();e.CommandExecutor=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n,r){if(!t||!n)throw new e.ArgumentException;this._executor=t,this._expression=n,this._parameter=r}return Object.defineProperty(t.prototype,"executor",{get:function(){return this._executor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expression",{get:function(){return this._expression},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parameter",{get:function(){return this._parameter},enumerable:!0,configurable:!0}),t}();e.CommandExecutorContext=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n,r,i){for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];if(this._next=null,!n)throw new e.ArgumentException("name");switch(r=e.StringUtils.trim(r,"/"," ","\t","\r","\n"),this._anchor=t,this._name=n.trim(),t){case 3:this._path=r?"/"+r+"/":"/";break;case 1:this._path=r?"./"+r+"/":"./";break;case 2:this._path=r?"../"+r+"/":"../";break;default:this._path=r?r+"/":""}this._fullPath=this._path+this._name,this._options=new e.CommandOptionCollection(i),this._arguments=o||new Array}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._fullPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"arguments",{get:function(){return this._arguments},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(e){this._next=e},enumerable:!0,configurable:!0}),t.parse=function(t){return e.CommandExpressionParser.instance.parse(t)},t}();e.CommandExpression=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){}return t.prototype.parse=function(t){if(!t)return null;for(var n=null,r=null,i=new e.StringReader(t);i.peek()>0;)if(r=this.onParse(i),null===n)n=r;else{for(var o=n;null!==o.next;)o=o.next;o.next=r}return i.dispose(),n},t.prototype.onParse=function(n){var r,i,o,a,s,u=new e.Set,c=new e.Map;for(r=(s=t.parsePath(n))[0],i=s[1],o=s[2];null!==(a=t.parsePair(n));)a.key?c.set(a.key,a.value):u.add(a.value);return new(e.CommandExpression.bind.apply(e.CommandExpression,[void 0,r,i,o,c].concat(u.values())))},t.parsePath=function(t){for(var n=0,r=new e.Set,i=0,o=0,a="",s="";(i=t.read())>0;){var u=String.fromCharCode(i);if("."===u&&4===n&&(u="/"),"."===u)switch(n){case 0:n=1,o=1;break;case 1:n=2,o=2;break;default:throw new e.InvalidOperationException("Invalid anchor of command path.")}else if("/"===u){if(3===n)throw new e.InvalidOperationException("Duplicate '/' slash characters.");0===n?o=3:4===n&&(r.add(a),a=""),n=3}else{if(!e.CharUtils.isLetterOrDigit(u)&&"_"!==u){if(e.CharUtils.isWhiteSpace(u)){if(0===n)continue;break}throw new e.InvalidOperationException("Contains '"+u+"' illegal character(s) in the command path.")}if(1===n||2===n)throw new e.InvalidOperationException("Missing '/' slash character between dot and letter or digit.");a+=u,n=4}}if(3===n&&(r&&r.size>0||3!==o))throw new e.InvalidOperationException("The command path can not at the end of '/' character.");if(r&&r.size>0)s=r.values().join(".");else if(!a){switch(o){case 3:a="/";break;case 1:a=".";break;case 2:a=".."}o=0}return[o,a,s]},t.parsePair=function(t){for(var n,r="\0",i=!1,o="",a="",s=0;(n=t.read())>0;){var u=String.fromCharCode(n);if("-"===u||"/"===u){if(1===s)throw new e.InvalidOperationException("Duplicate '"+u+"' option indicator of command expression.");if(0===s&&"\0"===r){s=1;continue}}else if(":"===u||"="===u){if(o&&3===s&&"\0"===r&&!i){s=2;continue}}else if("|"===u){if("\0"===r)return o||a?new e.KeyValuePair(o,a):null}else if(e.CharUtils.isWhiteSpace(u)){if(1===s)throw new e.InvalidOperationException("A white-space character at the back of the option indicator.");if(0===s)continue;if("\0"===r)return new e.KeyValuePair(o,a)}else if(this.isQuote(u)&&!i){if("\0"!==r){r="\0";continue}if(3!==s){r=u;continue}}if(!(i="\\"===u&&!i)){switch(s){case 1:o+=u;break;case 0:case 2:a+=u;break;default:a?a+=u:o+=u}s=3}}return o||a?new e.KeyValuePair(o,a):null},t.isQuote=function(e){return'"'===e||"'"===e},t.instance=new t,t}();e.CommandExpressionParser=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t){var n=this;this._items=new e.Map,t&&t.forEach(function(e){n._items.set(e.key,e.value)})}return Object.defineProperty(t.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this._items.keys()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this._items.values()},enumerable:!0,configurable:!0}),t.prototype.get=function(e){return this._items.get(e)},t.prototype.has=function(e){return this._items.has(e)},t.prototype.getEnumerator=function(){return this._items.getEnumerator()},t.prototype.forEach=function(e,t){this._items.forEach(e,t)},t}();e.CommandOptionCollection=t}(flagwind||(flagwind={})),function(e){e.command=function(t){if(!t)throw new e.InvalidOperationException("The command path is empty.");return function(n){if(!e.Type.isAssignableFrom(e.CommandBase,n))throw new e.InvalidOperationException("The class '"+e.Type.getQualifiedClassName(n)+"' is not a command type.");var r=e.Activator.createInstance(n);e.CommandExecutor.default.register(t,r)}}}(flagwind||(flagwind={})),function(e){var t=function(){function t(){}return t.isChar=function(t){return e.Type.isString(t)&&1===t.length},t.isLatin=function(e){return e.charCodeAt(0)<=255},t.isAscii=function(e){return e.charCodeAt(0)<=127},t.isLetterOrDigit=function(e){if(!this.isChar(e))return!1;return/^[0-9a-zA-Z]*$/g.test(e)},t.isWhiteSpace=function(e){if(!this.isChar(e))return!1;var t=e.charCodeAt(0);return 32===t||t>=9&&t<=13||160===t||133===t},t}();e.CharUtils=t}(flagwind||(flagwind={})),function(e){var t=function(e,t,n,r){this.name=e,this.value=t,this.alias=n||"",this.description=r||""};e.EnumEntry=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){}return t.getEntry=function(t,n){if(!n)throw new e.ArgumentException;var r=this.getEntries(n).filter(function(e){return e.value===t});return 1===r.length?r[0]:null},t.getEntries=function(t){if(!t)throw new e.ArgumentException;if(this._entryCache.has(t))return this._entryCache.get(t);for(var n=e.Type.getMetadata(t)||{},r=new Array,i=0,o=this.getFields(t);i<o.length;i++){var a=o[i],s=a[0],u=a[1],c=n[s],f=c?c.alias:"",p=c?c.description:"";r.push(new e.EnumEntry(s,u,f,p))}return r.length>0&&this._entryCache.set(t,r),r},t.getFields=function(t){if(!t)throw new e.ArgumentException;return Object.keys(t).map(function(e){return[e,t[e]]}).filter(function(t){t[0];var n=t[1];return e.Type.isNumber(n)})},t._entryCache=new e.Map,t}();e.EnumUtils=t}(flagwind||(flagwind={})),function(e){var t=function(){function e(){}return e.uri=/^([a-zA-Z0-9\.]+:\/\/)(.+)$/,e.scheme=/^([a-zA-Z0-9\.]+:\/\/)$/,e}();e.RegexUtils=t}(flagwind||(flagwind={})),function(e){var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n=function(){function e(){}return e.trim=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];e=e.replace(new RegExp("^"+o+"+|"+o+"+$","g"),"")}return e.trim()},e.isMobile=function(e){return/^1[34578]\d{9}$/.test(e)},e.isPassword=function(e){return e.length>=6&&e.length<=16},e.generateRandom=function(e){for(var n="",r=0;r<e;r++){var i=Math.ceil(35*Math.random());n+=t[i]}return n},e}();e.StringUtils=n}(flagwind||(flagwind={})),function(e){var t=function(){function t(){}return t.prototype.handle=function(t){var n,r=e.EnumUtils.getEntry(t.level,e.LogLevel);switch(t.level){case e.LogLevel.debug:n=console.log;break;case e.LogLevel.warn:n=console.warn;break;case e.LogLevel.error:n=console.error}n("[--------["+r.alias+"] "+t.timestamp.toLocaleString()+"--------"),n(t.message),t.data&&n(t.data),n(t.source),n("----------------------------------------------]")},t}();e.ConsoleLogHandler=t}(flagwind||(flagwind={})),function(e){var t=function(){function e(e,t,n,r){this._level=e,this._source=t,this._message=n,this._data=r,this._timestamp=new Date}return Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamp",{get:function(){return this._timestamp},enumerable:!0,configurable:!0}),e}();e.LogEntry=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){}return Object.defineProperty(t,"handlers",{get:function(){return this._handlers},enumerable:!0,configurable:!0}),t.debug=function(t,n,r){this.write(e.LogLevel.debug,t,n,r)},t.warn=function(t,n,r){this.write(e.LogLevel.warn,t,n,r)},t.error=function(t,n,r){this.write(e.LogLevel.error,t,n,r)},t.write=function(t,n,r,i){var o=new e.LogEntry(t,n,r,i);this._handlers.forEach(function(e){e.handle(o)})},t._handlers=new e.Set,t}();e.Logger=t}(flagwind||(flagwind={})),function(flagwind){var Type=function(){function Type(){}return Type.isArray=function(e){return"array"===this.getTypeString(e)},Type.isObject=function(e){return"object"===this.getTypeString(e)},Type.isString=function(e){return"string"==typeof e},Type.isDate=function(e){return"date"===this.getTypeString(e)},Type.isRegExp=function(e){return"regexp"===this.getTypeString(e)},Type.isFunction=function(e){return"function"==typeof e},Type.isBoolean=function(e){return"boolean"==typeof e},Type.isNumber=function(e){return"number"==typeof e},Type.isNull=function(e){return null===e},Type.isUndefined=function(e){return void 0===e},Type.isEmptyObject=function(e){return Type.isNull(e)||Type.isUndefined(e)},Type.isEmptyString=function(e){return Type.isEmptyObject(e)||""===e.trim()},Type.setMetadata=function(e,t){if(!e||!t)throw new Error;this._metadatas.set(e,t)},Type.getMetadata=function(e){return this._metadatas.get(e)||null},Type.getClassType=function(value){if(Type.isNull(value))return null;if(!Type.isUndefined(value)){if(Type.isBoolean(value))return Boolean;if(Type.isNumber(value))return Number;if(!Type.isString(value)){var prototype=value.prototype?value.prototype:Object.getPrototypeOf(value);return prototype.constructor}try{var ctor=eval(value);return Type.isFunction(ctor)?ctor:String}catch(e){return String}}},Type.getClassName=function(e){var t=this.getQualifiedClassName(e).split(".");return t[t.length-1]},Type.getQualifiedClassName=function(e){var t=typeof e;if(!e||"object"!==t&&!e.prototype)return t;var n=e.prototype?e.prototype:Object.getPrototypeOf(e);if(n.hasOwnProperty("__class__"))return n.__class__;var r=n.constructor.toString().trim(),i=r.indexOf("("),o=r.substring(9,i);return Object.defineProperty(n,"__class__",{value:o,enumerable:!1,writable:!0}),o},Type.getSuperclassName=function(e){var t=this.getQualifiedSuperclassName(e).split(".");return t[t.length-1]},Type.getQualifiedSuperclassName=function(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var t=e.prototype?e.prototype:Object.getPrototypeOf(e),n=Object.getPrototypeOf(t);if(!n)return null;var r=this.getQualifiedClassName(n.constructor);return r||null},Type.isAssignableFrom=function(e,t){if(!e||!t)return!1;if(e===t)return!0;if(e===Object||"Object"===e)return!0;var n=t.prototype;if(n.hasOwnProperty("__types__")){var r=Type.isString(e)?e:Type.getQualifiedClassName(e);return-1!==n.__types__.indexOf(r)}var i=Object.getPrototypeOf(n).constructor;if(i===Object)return!1;if(Type.isString(e)){if(Type.getQualifiedClassName(i)===e)return!0}else if(i===e)return!0;return Type.isAssignableFrom(e,i)},Type.getTypeString=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},Type._metadatas=new flagwind.Map,Type}();flagwind.Type=Type}(flagwind||(flagwind={})),function(e){var t;!function(e){e[e.debug=1]="debug",e[e.warn=2]="warn",e[e.error=3]="error"}(t=e.LogLevel||(e.LogLevel={})),e.Type.setMetadata(t,{debug:{alias:"DEBUG",description:"调试"},warn:{alias:"WARN",description:"警告"},error:{alias:"ERROR",description:"错误"}})}(flagwind||(flagwind={})),function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._cancel=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"cancel",{get:function(){return this._cancel},set:function(e){this._cancel=e},enumerable:!0,configurable:!0}),t}(e.EventArgs);e.CancelEventArgs=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){this._providers=new e.Map}return Object.defineProperty(t.prototype,"providers",{get:function(){return this._providers},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.getProvider=function(t){if(!t)throw new e.ArgumentException;var n=this._providers.get(t);return n||(n=this.createProvider(t),this._providers.set(t,n)),n},t.prototype.createProvider=function(t){return new e.EventProvider(t)},t}();e.EventProviderFactory=t}(flagwind||(flagwind={})),function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(Error);e.Exception=t}(flagwind||(flagwind={})),function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.Exception);e.ArgumentException=t}(flagwind||(flagwind={})),function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.Exception);e.InvalidOperationException=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){}return Object.defineProperty(t,"proxy",{get:function(){return!this._proxy&&window&&window.localStorage?window.localStorage:this._proxy},set:function(e){this._proxy=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"size",{get:function(){return this.proxy.length},enumerable:!0,configurable:!0}),t.set=function(t,n){if(!t)throw new e.ArgumentException;var r=this.serialize(n);this.proxy.setItem(t,r)},t.get=function(e){return this.deserialize(this.proxy.getItem(e))},t.remove=function(t){if(!t)throw new e.ArgumentException(t);this.proxy.removeItem(t)},t.clear=function(){this.proxy.clear()},t.serialize=function(t){return e.Type.isUndefined(t)||e.Type.isFunction(t)?t+"":JSON.stringify(t)},t.deserialize=function(e){try{return JSON.parse(e)}catch(t){return e||void 0}},t}();e.LocalStorage=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t){if(!t)throw new e.ArgumentException;this._text=t,this._position=0,this._length=t.length}return t.prototype.peek=function(){return this._position===this._length?-1:this._text.charCodeAt(this._position)},t.prototype.read=function(){if(this._position===this._length)return-1;var e=this._position;return this._position++,this._text.charCodeAt(e)},t.prototype.readToEnd=function(){var e=0!==this._position?this._text.substring(this._position,this._length):this._text;return this._position=this._length,e},t.prototype.readLine=function(){var e,t=this._text;for(e=this._position;e<this._length;++e){var n=t.charCodeAt(e);switch(String.fromCharCode(n)){case"\r":case"\n":var r=t.substring(this._position,e);return this._position=e+1,13===n&&this._position<this._length&&10===t.charCodeAt(this._position)&&this._position++,r;default:continue}}if(e<=this._position)return null;var i=t.substring(this._position,e);return this._position=e,i},t.prototype.dispose=function(){this._text=null,this._position=0,this._length=0},t}();e.StringReader=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(){}return t.createInstance=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i,o=this._types;if(e.Type.isString(t))if(t=t,o.has(t))i=o.get(t);else{if((i=e.Type.getClassType(t))===String)throw new TypeError("Can not found the type '"+t+"'.");o.set(t,i)}else e.Type.isFunction(t)&&(i=t);return new(i.bind.apply(i,[void 0].concat(n)))},t._types=new e.Map,t}();e.Activator=t}(flagwind||(flagwind={})),function(e){e.injectable=function(t){return function(n){var r=e.ServiceProviderFactory.instance;(t?r.getProvider(t):r.default).register(n)}}}(flagwind||(flagwind={})),function(e){var t=function(){function t(){this._name=null,this._service=null,this._serviceType=null,this._contractTypes=null,this._serviceBuilder=null;var t=arguments;switch(t.length){case 1:case 2:e.Type.isFunction(t[0])?this._serviceType=t[0]:(this._service=t[0],this._serviceType=e.Type.getClassType(t[0])),this._contractTypes=t[1]||null;break;case 3:this._name=t[0],e.Type.isFunction(t[1])?this._serviceType=t[1]:(this._service=t[1],this._serviceType=e.Type.getClassType(t[1])),this._contractTypes=t[2]||null}}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serviceType",{get:function(){if(!this._serviceType){var t=this._service;t&&(this._serviceType=e.Type.getClassType(t))}return this._serviceType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"service",{get:function(){return this._service||(this._service=this.createService()),this._service},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasService",{get:function(){return!!this._service},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasContracts",{get:function(){return this._contractTypes&&this._contractTypes.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contractTypes",{get:function(){return this._contractTypes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serviceBuilder",{get:function(){return this._serviceBuilder},set:function(e){this._serviceBuilder=e},enumerable:!0,configurable:!0}),t.prototype.toString=function(){var t=e.Type.getQualifiedClassName(this.serviceType);return e.Type.isEmptyString(this.name)?t:this.name+" ("+t+")"},t.prototype.createService=function(){var t=this._serviceBuilder;if(t){var n=t.build(this);return n&&(this._serviceType=e.Type.getClassType(n)),n}var r=this._serviceType;return r?e.Activator.createInstance(r):null},t}();e.ServiceEntry=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t,n){t=t||new e.ServiceStorage(this),this._storage=t,this._builder=n}return Object.defineProperty(t.prototype,"storage",{get:function(){return this._storage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"builder",{get:function(){return this._builder},enumerable:!0,configurable:!0}),t.prototype.register=function(){var t,n=arguments;switch(n.length){case 1:case 2:t=e.Type.isString(n[0])?new e.ServiceEntry(n[0],n[1],null):new e.ServiceEntry(n[0],n[1]);break;case 3:t=new e.ServiceEntry(n[0],n[1],n[2])}if(!t)throw new e.ArgumentException("Can not register service, please check the arguments.");this._storage.add(t)},t.prototype.unregister=function(e){this._storage.remove(e)},t.prototype.resolve=function(){var t=this._storage.get(arguments[0]);return e.Type.isEmptyObject(t)?null:this.getService(t)},t.prototype.resolveAll=function(t){var n=this,r=new e.Set;return this._storage.getAll(t).forEach(function(e){r.add(n.getService(e))}),r},t.prototype.getService=function(t){if(!t)return null;var n=t.service;if(e.Type.isEmptyObject(n)){var r=this._builder;r&&(n=r.build(t))}return n||e.Activator.createInstance(t.serviceType)},t}();e.ServiceProvider=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t){void 0===t&&(t=""),this._defaultName=t,this._providers=new e.Map}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"default",{get:function(){var t=this.getProvider(this._defaultName);return t||(t=new e.ServiceProvider,this.register(this._defaultName,t)),t},set:function(t){if(!t)throw new e.ArgumentException;this.register(this._defaultName,t)},enumerable:!0,configurable:!0}),t.prototype.register=function(t,n){if(e.Type.isEmptyObject(t))throw new e.ArgumentException("name");this._providers.set(t.trim(),n)},t.prototype.unregister=function(t){if(e.Type.isEmptyObject(t))throw new e.ArgumentException;this._providers.delete(t.trim())},t.prototype.getProvider=function(t){if(e.Type.isEmptyObject(t))throw new e.ArgumentException("name");return t=t.trim(),this._providers.has(t)?this._providers.get(t):null},t.prototype.getEnumerator=function(){return this._providers.getEnumerator()},t.prototype.forEach=function(e,t){this._providers.forEach(e,t)},t}();e.ServiceProviderFactory=t}(flagwind||(flagwind={})),function(e){var t=function(){function t(t){if(!t)throw new e.ArgumentException("provider");this._provider=t}return Object.defineProperty(t.prototype,"provider",{get:function(){return this._provider},enumerable:!0,configurable:!0}),t.prototype.add=function(){var t,n=arguments;switch(n.length){case 1:t=n[0]instanceof e.ServiceEntry?n[0]:new e.ServiceEntry(n[0],null);break;case 2:t=e.Type.isString(n[0])?new e.ServiceEntry(n[0],n[1],null):new e.ServiceEntry(n[0],n[1]);break;case 3:t=new e.ServiceEntry(n[0],n[1],n[2])}if(!t)throw new e.ArgumentException("Can not add service, please check the arguments.");return this.insert(t),t},t.prototype.get=function(){var t=arguments,n=null;if(e.Type.isString(t[0])){n=this.findByName(t[0],new e.Set(this));var r=e.ServiceProviderFactory.instance.default;!n&&r&&r.storage!==this&&(n=this.findByName(t[0],new e.Set(r.storage))),n||(n=this.findByType(t[0],!1))}else n=this.findByType(t[0],!1);return n},t.prototype.getAll=function(e){return this.findByType(e,!0)},t.prototype.findByName=function(t,n){if(!t||!n)return null;for(var r=0;r<n.size;r++)for(var i=n.get(r).getEnumerator();i.next();){var o=i.current;if(o){if(o.name===t)return o;if(o.serviceType&&e.Type.isAssignableFrom(e.ServiceProvider,o.serviceType)){var a=o.service;a&&!n.has(a.storage)&&n.add(a.storage)}}}return null},t.prototype.findByType=function(t,n){var r=this.searchService(t,n,new e.Set(this)),i=!e.Type.isEmptyObject(r);i&&r instanceof e.Set&&0===r.size&&(i=!1);var o=e.ServiceProviderFactory.instance.default;return!i&&o&&o.storage!==this&&(r=this.searchService(t,n,new e.Set(o.storage))),r},t.prototype.searchService=function(t,n,r){if(!t||!r)return null;for(var i=new e.Set,o=new e.Set,a=0;a<r.size;a++){for(var s=r.get(a).getEnumerator();s.next();){var u=s.current;if(u&&u.serviceType){if(u.hasContracts)if(e.Type.isFunction(t)&&-1!==u.contractTypes.indexOf(t)){if(!n)return u;o.add(u)}else for(var c=0,f=u.contractTypes;c<f.length;c++){var p=f[c];e.Type.isAssignableFrom(t,p)&&i.add(u)}else if(e.Type.isFunction(t)&&u.serviceType===t){if(!n)return u;o.add(u)}else e.Type.isAssignableFrom(t,u.serviceType)&&i.add(u);if(!n){if(i.size>0)break;if(u.serviceType&&e.Type.isAssignableFrom(e.ServiceProvider,u.serviceType)){var l=u.service;l&&!r.has(l.storage)&&r.add(l.storage)}}}}if(n)return o.union(i);if(i.size>0)return i.get(0)}return null},t}();e.ServiceStorageBase=t}(flagwind||(flagwind={})),function(e){var t=function(t){function n(n){var r=t.call(this,n)||this;return r._entries=new e.Set,r._namedEntries=new e.Map,r}return __extends(n,t),Object.defineProperty(n.prototype,"size",{get:function(){return this._entries.size},enumerable:!0,configurable:!0}),n.prototype.clear=function(){this._entries.clear(),this._namedEntries.clear()},n.prototype.remove=function(e){if(!e)return null;var t=null;return this._namedEntries.has(e)&&(t=this._namedEntries.get(e),this._entries.delete(t),this._namedEntries.delete(e)),t},n.prototype.get=function(){var n=arguments;return e.Type.isString(n[0])&&this._namedEntries.has(n[0])?this._namedEntries.get(n[0]):t.prototype.get.call(this,n[0])},n.prototype.getEnumerator=function(){return this._entries.getEnumerator()},n.prototype.forEach=function(e,t){this._entries.forEach(e,t)},n.prototype.insert=function(t){if(!t)throw new e.ArgumentException;t.name&&this._namedEntries.set(t.name,t),this._entries.add(t)},n}(e.ServiceStorageBase);e.ServiceStorage=t}(flagwind||(flagwind={})),function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.STATE_CHANGED="stateChanged",n._name=e,n._disabled=!1,n._canPauseAndContinue=!1,n._state=0,n}return __extends(n,t),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled!==e&&(this._disabled=e,e&&this.stop())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canPauseAndContinue",{get:function(){return this._canPauseAndContinue},set:function(t){if(0!==this._state)throw new e.InvalidOperationException;this._canPauseAndContinue=t},enumerable:!0,configurable:!0}),n.prototype.start=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){switch(r.label){case 0:if(this._disabled||0!==this._state)return[2];this._state=1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.onStart.apply(this,t)];case 2:return r.sent(),this._state=2,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"start",2)),[3,4];case 3:throw n=r.sent(),this._state=0,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"start",0,n)),n;case 4:return[2]}})})},n.prototype.stop=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(i){switch(i.label){case 0:if(n=this._state,this._disabled||6===n||0===n)return[2];this._state=6,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.onStop.apply(this,t)];case 2:return i.sent(),this._state=0,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"stop",0)),[3,4];case 3:throw r=i.sent(),this._state=n,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"stop",n,r)),r;case 4:return[2]}})})},n.prototype.pause=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:if(t=this._state,this._disabled||!this._canPauseAndContinue)return[2];if(2!==t)return[2];this._state=3,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.onPause()];case 2:return r.sent(),this._state=4,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"pause",4)),[3,4];case 3:throw n=r.sent(),this._state=t,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"pause",t,n)),n;case 4:return[2]}})})},n.prototype.resume=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:if(t=this._state,this._disabled||!this._canPauseAndContinue)return[2];if(4!==t)return[2];this._state=5,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.onResume()];case 2:return r.sent(),this._state=2,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"resume",2)),[3,4];case 3:throw n=r.sent(),this._state=t,this.onStateChanged(new e.WorkerStateChangedEventArgs(this.STATE_CHANGED,"resume",t,n)),n;case 4:return[2]}})})},n.prototype.onPause=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},n.prototype.onResume=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},n.prototype.onStateChanged=function(e){this.dispatchEvent(this.STATE_CHANGED,e)},n}(e.EventProvider);e.WorkerBase=t}(flagwind||(flagwind={})),function(e){var t=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.actionName=n,o.state=r,o.error=i,o}return __extends(t,e),t}(e.EventArgs);e.WorkerStateChangedEventArgs=t}(flagwind||(flagwind={})),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=flagwind},factory(exports)}});